<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta content = "text/html;charset=utf-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name = "google-signin-client_id" content = "902483045322-ame66rsf4mu0cklmgavrh4d2u5dr57f9.apps.googleusercontent.com";


    <script src = "https://apis.google.com/js/api.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi" crossorigin="anonymous">
    <link rel = "stylesheet" type = "text/css" href = "css.css">
	
	<script>
        function clickMe(){
		console.log("clickMe()");
                var one = document.getElementById("mapname").value;
		var two = document.getElementById("x").value;
		var three = document.getElementById("y").value;
		
		var request = new XMLHttpRequest();
		request.onreadystatechange = function(){
			if(request.readyState == 4 && request.status == 200){
				console.log("ready to send " + request.responseText);
				console.log("ready to send " + request.status);
				//document.getElementById("text").innerHTML = request.responseText;   
				var foo = request.responseText;
				alert(foo);
        		}
			console.log("responseText " + request.reponseText);
			console.log("status " + request.status);
		}
		if(one && two && three){
			console.log("map " + one + " x " + two + " y " + three);
			request.open("POST","/api/insertMap?mapname="+one+"&x="+two+"&y="+three, true);
			request.send(null);
		}else if(one && !two && !three){
			console.log("only map " + one + " not x " + two + " not y " + three);
			request.open("GET","/api/getMap?mapname="+one, true);
			request.send(null);
		}else{
			console.log(" not map " + one + " not x " + two + " not y " + three);
			request.open("GET","/api/getAll", true);
			request.send(null);
		}
	}
        </script>
</head>
  <body>
  <nav class="navbar navbar-default navbar-fnt navbar-backgrnd navbar-full" id="nav-main">
    		<ul class="nav navbar-nav">
    			<li class="nav-item">
    				<a class="nav-link" href="#">Home<span class="sr-only">(current)</span></a>
    			</li>
    			<li class="nav-item">
		    		<a class="navbar-brand" href="login.html"> Login</a>
		    	</li>
		    	<li class="nav-item">
		    		<a class="navbar-brand" href="register.html"> Register</a>
		    	</li>
		    	<li class="nav-item">
		    		<a class="navbar-brand" href=""> Upload</a>
		    	</li>
		    	<li class="nav-item">
		    		<a class="navbar-brand" href="geomapCluster.html"> My map</a>
		    	</li>
		    	<li class="nav-item">
		    		<a class="navbar-brand" href=""> Mineral info</a>
		    	</li>
		    	<li class="nav-item">
		    		<a class="navbar-brand" href=""> About</a>
		    	</li>
		    </ul>
  </nav>
  <div class="container">
   <h1><center>Welcome to your personal map handler.</center></h1>
    <center>
     <form class="form-inline">
      <div class="form-group">
       <input type="text" id ="mapname" name="mapname" class="form-control form-control-lg" placeholder="Identification name">
      </div>
      <div class="form-group">
       <input type="text" id ="x" name="x" class="form-control form-control-lg" placeholder="Longitude">
      </div>
      <div class="form-group">
       <input type="text" id="y" name="y"class="form-control form-control-lg" placeholder="Latitude">
      </div>
      <br/>
      <input type="button" name="submit" value="Action" onclick="clickMe()" class="btn btn-success btn-lg">
     </form>
    </center>  
	
	<div class="map" id="map">
	<center>
	<script>    
      	function initMap() {
	console.log("initMap");
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: {lat: -28.024, lng: 140.887}
        });
	//Create a simple menu for markers and circles that can be placed anywhere on the map.
	var drawingManager = new google.maps.drawing.DrawingManager({
	  drawingMode: google.maps.drawing.OverlayType.MARKER,
	  drawingControl: true,
	  drawingControlOptions: {
	    position: google.maps.ControlPosition.TOP_CENTER,
	    drawingModes: ['marker','circle']
	  },
	  circleOptions: {
	    fillColor: '#fff00',
	    fillOpacity: 1,
	    strokeweight: 5,
	    clickable: false,
	    editable: true,
	    zIndex: 1
	  }
	});
	drawingManager.setMap(map);
	// Create an array of alphabetical characters used to label the markers.
        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
          });
        });
        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
      }
      var locations = foo;
	/*
      var locations = [
        {lat: -31.563910, lng: 147.154312},
        {lat: -33.718234, lng: 150.363181},
        {lat: -33.727111, lng: 150.371124},
        {lat: -33.848588, lng: 151.209834},
        {lat: -33.851702, lng: 151.216968},
        {lat: -34.671264, lng: 150.863657},
        {lat: -35.304724, lng: 148.662905},
        {lat: -36.817685, lng: 175.699196},
        {lat: -36.828611, lng: 175.790222},
        {lat: -37.750000, lng: 145.116667},
        {lat: -37.759859, lng: 145.128708},
        {lat: -37.765015, lng: 145.133858},
        {lat: -37.770104, lng: 145.143299},
        {lat: -37.773700, lng: 145.145187},
        {lat: -37.774785, lng: 145.137978},
        {lat: -37.819616, lng: 144.968119},
        {lat: -38.330766, lng: 144.695692},
        {lat: -39.927193, lng: 175.053218},
        {lat: -41.330162, lng: 174.865694},
        {lat: -42.734358, lng: 147.439506},
        {lat: -42.734358, lng: 147.501315},
        {lat: -42.735258, lng: 147.438000},
	{lat: 59.3293234, lng: 18.0685808}
      ]
	*/
	</script>
	</center>
 
   	<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    	</script>
    	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_O-DWv_X7RsiS9oQuqAeNCrwpJPcgrDM&signed_in=true&libraries=drawing&callback=initMap">
	</script>
	</div>

	<div id = "text">
	</div>
</body>
</html>
